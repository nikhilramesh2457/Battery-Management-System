<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Battery Health Check</title>
    <link href="{{ url_for('static', path='/style.css') }}" rel="stylesheet" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
      crossorigin="anonymous" />
  </head>
  <body>
    <nav class="navbar bg-light">
      <div class="container-fluid">
        <a class="navbar-brand">Renewables Lab Battery Status</a>
        <form class="d-flex">
          <span
            >{{state["timestamp"]}} <br />
            Last checked</span
          >
        </form>
      </div>
    </nav>
    <div class="row">
      {% for number, p_state in state["panel_status"].items() %}
      <div class="col-sm-6" style="width: fit-content; padding-bottom: 5%">
        <div class="card">
          <div class="card-body" style="z-index: 2;">
            {% if p_state == 1 %}
            <h5 class="card-title">
              <i
                class="bi bi-collection-fill"
                style="font-size: 2rem; color: orange"></i>
            </h5>
            {% else %}
            <h5 class="card-title">
              <i class="bi bi-collection-fill" style="font-size: 2rem"></i>
            </h5>
            {% endif %}

            <p class="card-text">
              Panel: <strong>{{ number }} </strong> <br />
              <hide>Voltage: <strong>22.2 V</strong></hide>
            </p>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
    <div class="row">
      {% for battery_state in state["battery_status"].items() %}
      <div class="col-sm-6" style="width: fit-content; padding-bottom: 5%">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title">
              <!-- Charging Battery -->
              {% if battery_state[1]["charging"] == 1 %}
              <i
                class="bi bi-battery-charging"
                style="font-size: 2rem; color: cornflowerblue"></i>

              <!-- Full Battery -->
              {% elif battery_state[1]["voltage"] >= 11.5 %}
              <i
                class="bi bi-battery-full"
                style="font-size: 2rem; color: darkgreen"></i>

              <!-- Half Battery -->
              {% elif 10.5 < battery_state[1]["voltage"] < 11.5 %}
              <i
                class="bi bi-battery-half"
                style="font-size: 2rem; color: orange"></i>

              <!-- Battery Empty -->
              {% elif battery_state[1]["voltage"] < 10.6 %}
              <i class="bi bi-battery" style="font-size: 2rem; color: red"></i>
              {% endif %}
            </h5>
            <p class="card-text">
              Battery:
              <strong>{{ '%02d' | format(battery_state[0] | int + 1) }}</strong>
              <br />
              Voltage: <strong>{{battery_state[1]["voltage"]}} V</strong> <br/>
              <hide>Voltage: <strong>22.2 V</strong></hide>
            </p>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
      crossorigin="anonymous"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
      integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3"
      crossorigin="anonymous"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"
      integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V"
      crossorigin="anonymous"></script>
  </body>
</html>
